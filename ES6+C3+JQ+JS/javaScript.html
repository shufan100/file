<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>JavaScript知识点</title>
    <link rel="stylesheet" type="text/css" href="./css/reset.css" />
  </head>

  <style type="text/css">
    html,
    body {
      padding: 10px;
    }
    h1 {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      text-shadow: 5px 5px 5px #ff0000;
      margin-bottom: 10px;
    }
  </style>

  <body>
    <h1>JavaScript知识点</h1>
  </body>
</html>
<script type="text/javascript">
  
  let arrayData = [
  { id: 5, pid: 0, name: 'name-5', },
  { id: 1, pid: 0, name: 'name-1', },
  { id: 2, pid: 1, name: 'name-2', },
  { id: 3, pid: 2, name: 'name-3', },
  { id: 4, pid: 2, name: 'name-4', },
]
function arrayToTreeData(arr) {
  return arr.map(i=>({ ...i,children: arr.filter(j=>j.pid == i.id) || []})).find(item=>item.children.length)
}
let tree = arrayToTreeData(arrayData)
console.log(tree);

var a = 1;
var b = [];
var c = '';
var d = true;

console.log((a || b) === true)
console.log((b && c) === true)
console.log((c && d) === true)
console.log((d || a) === true)
/**
 * // 数组对象说明：
// id：唯一ID，从1开始
// pid：父ID 即id值，默认为 0
// name: 名称

 1.1、请写一个函数将此arrayData数组, 根据 pid 变换为树形结构对象。
// 数组 根据 pid 转化为 树形结构
function arrayToTreeData(arg) {
	
}
1.2、请再写一个函数将返回的树形结构对象转化为一维数组，并根据 id 进行降序排序。
 // 树形结构 转化为 数组 并 根据 id 进行降序
  function treeDataToArray(arg) {
	
}

*/

const data = [
  {id:"01", name: "张大大", pid:"", job: "项目经理"},
  {id:"01", name: "张大大55555", pid:"", job: "项目经理5555"},
  {id:"02", name: "小亮", pid:"01", job: "产品leader"},
  {id:"03", name: "小美", pid:"01", job: "UIleader"},
  {id:"04", name: "老马", pid:"01", job: "技术leader"},
  {id:"05", name: "老王", pid:"01", job: "测试leader"},
  {id:"06", name: "老李", pid:"01", job: "运维leader"},
  {id:"07", name: "小丽", pid:"02", job: "产品经理"},
  {id:"08", name: "大光", pid:"02", job: "产品经理"},
  {id:"09", name: "小高", pid:"03", job: "UI设计师"},
  {id:"10", name: "小刘", pid:"04", job: "前端工程师"},
  {id:"11", name: "小华", pid:"04", job: "后端工程师"},
  {id:"12", name: "小李", pid:"04", job: "后端工程师"},
  {id:"13", name: "小赵", pid:"05", job: "测试工程师"},
  {id:"14", name: "小强", pid:"05", job: "测试工程师"},
  {id:"15", name: "小涛", pid:"06", job: "运维工程师"}
]
function arrToTree(data) {
        // 1.先筛选出项目经理（张大大）
        // 创建一个空对象 用来装项目经理
        pM = {};
        data.forEach((arr) => {
          arr.lable = arr["name"];
          delete arr.name;
          delete arr.job;
          if (arr.id === "01") {
            // console.log(arr);
            delete arr.id;
            delete arr.pid;
            pM = arr;
            // console.log(pM); // lable:张大大
          }
        });
        // 2. 找出项目经理对应pid为01的成员
        // 给项目经理创建Children数组
        pM.Children = [];
        data.forEach((arr) => {
          if (arr.pid === "01") {
            // 解构赋值
            const nArr = { ...arr };
            // 给pid为01的成员创建Children数组
            nArr.Children = [];
            // console.log(nArr);
            // 把pid为01的成员添加到项目经理.Children数组里
            pM.Children.push(nArr);
            // console.log(nArr);
          }
        });
        // 3. 找出剩余成员
        // 判断条件：pid不能为空 且不能等于 01
        const rests = data.filter((arr) => {
          return arr.pid !== "" && arr.pid !== "01";
        });
        // rests = 筛选好的剩余成员
        rests.forEach((arr) => {
          //再遍历大项目经理手下成员的id号与剩余成员对应的pid号
          pM.Children.forEach((item) => {
            if (arr.pid === item.id) {
              delete arr.id;
              delete arr.pid;
              //  再对应添加到相匹配的成员
              item.Children.push(arr);
              //   console.log(item);
            }
          });
        });
        pM.Children.forEach((arr) => {
          delete arr.id;
          delete arr.pid;
        });
        return pM;
      }
      const treeData = arrToTree(data);
      console.log(treeData);
</script>
