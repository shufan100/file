var r=(s,t,e)=>new Promise((a,o)=>{var i=n=>{try{d(e.next(n))}catch(l){o(l)}},c=n=>{try{d(e.throw(n))}catch(l){o(l)}},d=n=>n.done?a(n.value):Promise.resolve(n.value).then(i,c);d((e=e.apply(s,t)).next())});import{A as m,u as h,bO as p,bP as g,bQ as _,bR as f,j as y,o as I}from"./index.5bf7a2f0.js";const u=h(),$={name:"redirectLogin",data(){return{finPageName:"\u767B\u5F55\u9875\u9762"}},mounted(){this.openLoading(),this.login()},methods:{_addMenuRouter(s){return addMenuRouter.getISCMenuRouter(s).then(t=>t)},getTransmissionMode(){return r(this,null,function*(){const{encryptFlag:s,whiteList:t}=yield this.$hi_http(p)(),e=g.exports.sm.decrypt({encryptValue:t.V,encryptKey:t.C}).data;u.$patch({iscUrlWhiteList:e,transmissionMode:s})})},login(){return r(this,null,function*(){yield this.getTransmissionMode();const s=yield this.getUrlParams(),{result:t}=yield this.$hi_http(_)(s),e=t.additionalInfo.menu_list?t.additionalInfo.menu_list.children:[],a=yield this._addMenuRouter(e);this.$store.state.roleName=t.additionalInfo.roleName,this.$store.state.appId=t.additionalInfo.appId,this.$store.state.tenantId=t.additionalInfo.tenantId,delete t.additionalInfo.menu_list,this.setSystems({accessTokenResultVO:t}),this.setAppid(t.additionalInfo.appId),setStorage("hyit:menuRouterData",a),this.$router.addRoutes(a),this.$router.push({name:"home"})})},getUrlParams(){return r(this,null,function*(){const s=window.location.hash.slice(1),t={};s&&s.split("&").forEach(o=>{const[i,c]=o.split("=");t[i]=c});const e=Object.keys(t).length===0,{accessToken:a}=u.system;if(a)return this.$router.push("/home"),Promise.reject();if(e)return Promise.reject();if(!e)return this.setIscToken(t.access_token),Promise.resolve(t)})},openLoading(){f.service({background:"rgba(0, 0, 0, 0.3)"})}}},k={class:"redlrectLogin"};function w(s,t,e,a,o,i){return I(),y("div",k)}var P=m($,[["render",w],["__file","E:/project/\u4E3B\u5DE5\u7A0B/fin-main-app/src/views/redirectLogin.vue"]]);export{P as default};
